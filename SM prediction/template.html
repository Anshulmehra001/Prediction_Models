
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Phoenix Forecaster</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
            body { background-color: #f0f2f5; } .container { max-width: 1200px; }
            .card { box-shadow: 0 4px 8px rgba(0,0,0,0.1); } .report-metric .value { font-size: 2rem; font-weight: bold; }
            .report-metric .label { color: #6c757d; } .win { color: #198754; } .loss { color: #dc3545; }
        </style>
    </head>
    <body>
        <div class="container my-5">
            <div class="card">
                <div class="card-header bg-dark text-white text-center"><h1>ðŸ”¥ Phoenix Forecaster</h1><p class="mb-0">A Professional-Grade Quantitative Backtesting & Forecasting Tool</p></div>
                <div class="card-body">
                    <div class="row"><div class="col-md-6"><label for="ticker" class="form-label">Stock/Crypto Ticker</label><input type="text" class="form-control" id="ticker" value="BTC-USD"></div>
                        <div class="col-md-6"><label for="days" class="form-label">Days to Backtest</label><input type="number" class="form-control" id="days" value="252"></div>
                    </div><div class="d-grid mt-3"><button class="btn btn-primary" id="runBtn" onclick="startBacktest()">Run Genuine Backtest</button></div>
                </div>
            </div>
            <div id="progress-container" class="my-4" style="display: none;"><div class="card"><div class="card-body">
                <h4 class="text-center">Backtest in Progress...</h4><p class="text-center text-muted">This is a 100% genuine walk-forward backtest, retraining the model daily. This process is intentionally slow to ensure accuracy. Please be patient.</p>
                <div class="progress" style="height: 30px;"><div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;"></div></div>
                <p id="progress-message" class="text-center mt-2"></p></div></div></div>
            <div id="error-container" class="my-4" style="display: none;"><div class="alert alert-danger"><h4>An Error Occurred</h4><p id="error-message"></p></div></div>
            <div id="results-container" class="my-4" style="display: none;"><div class="card"><div class="card-header text-center"><h2>Backtest Report for <span id="report-ticker"></span></h2></div>
                <div class="card-body"><h4>Quantitative Performance Metrics</h4><div class="row border rounded p-3 my-3">
                    <div class="col report-metric" id="win-rate"></div><div class="col report-metric" id="profit-factor"></div><div class="col report-metric" id="sharpe-ratio"></div><div class="col report-metric" id="max-drawdown"></div>
                </div><h4>Performance Visualizations</h4><div class="text-center">
                    <img id="equity-curve-plot" class="img-fluid my-2 border rounded"><img id="drawdown-plot" class="img-fluid my-2 border rounded"><img id="vs-actual-plot" class="img-fluid my-2 border rounded">
                </div><h4 class="mt-4">Detailed Trade Log</h4><div id="trade-log" style="height: 400px; overflow-y: scroll;" class="border rounded"></div></div></div></div>
        </div>
        <script>
            let intervalId;
            async function startBacktest() {
                const ticker = document.getElementById('ticker').value.toUpperCase(); const days = parseInt(document.getElementById('days').value);
                if (!ticker || !days) { alert('Please enter a ticker and number of days.'); return; }
                document.getElementById('runBtn').disabled = true; document.getElementById('runBtn').innerHTML = '<span class="spinner-border spinner-border-sm"></span> Starting...';
                document.getElementById('progress-container').style.display = 'block'; document.getElementById('results-container').style.display = 'none'; document.getElementById('error-container').style.display = 'none';
                const response = await fetch('/start_backtest', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({symbol: ticker, days: days}) });
                const data = await response.json();
                intervalId = setInterval(() => checkStatus(data.task_id), 2000);
            }
            async function checkStatus(taskId) {
                const response = await fetch(`/backtest_status/${taskId}`); const data = await response.json();
                const progressMsg = document.getElementById('progress-message'); const progressBar = document.getElementById('progress-bar');
                if (data.status === 'running') {
                    progressMsg.textContent = data.message;
                    if (data.progress) { progressBar.style.width = `${data.progress}%`; }
                } else if (data.status === 'complete') {
                    clearInterval(intervalId); document.getElementById('progress-container').style.display = 'none';
                    document.getElementById('results-container').style.display = 'block'; document.getElementById('report-ticker').textContent = document.getElementById('ticker').value.toUpperCase();
                    const report = data.report;
                    document.getElementById('win-rate').innerHTML = `<div class="value win">${report.win_rate}</div><div class="label">Win Rate</div>`;
                    document.getElementById('profit-factor').innerHTML = `<div class="value">${report.profit_factor}</div><div class="label">Profit Factor</div>`;
                    document.getElementById('sharpe-ratio').innerHTML = `<div class="value">${report.sharpe_ratio}</div><div class="label">Sharpe Ratio</div>`;
                    document.getElementById('max-drawdown').innerHTML = `<div class="value loss">${report.max_drawdown}</div><div class="label">Max Drawdown</div>`;
                    document.getElementById('vs-actual-plot').src = 'data:image/png;base64,' + data.plots.vs_actual;
                    document.getElementById('equity-curve-plot').src = 'data:image/png;base64,' + data.plots.equity_curve;
                    document.getElementById('drawdown-plot').src = 'data:image/png;base64,' + data.plots.drawdown;
                    document.getElementById('trade-log').innerHTML = data.trade_log;
                    document.getElementById('runBtn').disabled = false; document.getElementById('runBtn').innerHTML = 'Run Genuine Backtest';
                } else if (data.status === 'error') {
                    clearInterval(intervalId); document.getElementById('progress-container').style.display = 'none';
                    document.getElementById('error-container').style.display = 'block';
                    document.getElementById('error-message').textContent = data.message;
                    document.getElementById('runBtn').disabled = false; document.getElementById('runBtn').innerHTML = 'Run Genuine Backtest';
                }
            }
        </script>
    </body>
    </html>
    